<!DOCTYPE html>
<html lang="">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{.TextName}} 赛码结果</title>
  </head>
  <style>
    body {
      background: rgb(240, 244, 245);
    }

    #header {
      display: flex;
      flex-direction: column;
      text-align: center;
      padding-top: 1rem;
    }

    #textFileName {
      font-size: x-large;
      font-weight: bold;
      padding-bottom: 0.5rem;
    }

    #content {
      display: flex;
      justify-content: center;
      min-width: fit-content;
      text-align: left;
      margin: 0.5rem;
    }

    .reportCard {
      display: flex;
      flex-direction: column;
      transition: 0.2s;
      width: 31rem;
      margin: 0.8rem;
      padding: 0.8rem;
      background-color: #fefefe;
      border: none;
      border-radius: 10px;
    }

    .reportCard:hover {
      box-shadow: 0 0 6px 0 #bbb;
    }

    .cardBlock.schemaInfo {
      display: flex;
      align-items: end;
      justify-content: start;
      font-size: larger;
      font-weight: bold;
      padding-left: 0.2rem;
    }

    .dictLen {
      padding-left: 1rem;
      font-size: 0.8em;
      color: lightslategray;
      white-space: nowrap;
    }

    .dictLenValue {
      font-size: 0.7em;
      font-weight: normal;
    }

    .cardBlock {
      padding: 0.5rem 0;
    }

    table {
      table-layout: fixed;
    }

    th {
      color: lightslategray;
    }

    .tableBasic {
      min-width: 80%;
    }

    .keyRateTitle {
      text-align: center;
      font-weight: bold;
      padding-bottom: 0.5rem;
    }

    .heatMap {
      width: 100%;
      border-spacing: 6px 6px;
    }

    .key {
      padding: 0.1rem;
      border-radius: 5px;
      box-shadow: 0 0 2px 0 #bbb;
    }

    td.key {
      text-align: center;
    }

    .heatMapRate {
      text-align: center;
      font-size: 0.5em;
      color: rgb(0, 0, 4, 0.4);
    }

    .fin {
      font-size: smaller;
    }

    .finHeatMap td {
      white-space: nowrap;
    }

    .tableBasic {
      min-width: 80%;
    }

    .tableFeel {
      min-width: 80%;
    }

    .cardBlock.stat {
      display: flex;
      align-items: flex-start;
    }

    .statHead th {
      padding-right: 0.5rem;
      white-space: nowrap;
    }

    .statTable {
      display: flex;
      overflow-x: auto;
    }

    .statTable > table td {
      padding-right: 0.2rem;
    }

    #footer {
      text-align: center;
    }
  </style>

  <body>
    <div id="header">
      <div id="textFileName">{{.TextName}}</div>
      <div id="textLen">文本字数 {{.TextLen}}； 非汉字数 {{.NotHanCount}}</div>
    </div>

    <div id="content">
      {{range .Results}}
      <div class="reportCard">
        <div class="cardBlock schemaInfo">
          <div class="dictName">{{.Name}}</div>
          <div class="dictLen">词条数：</div>
          <div class="dictLenValue">{{.Basic.DictLen}}</div>
        </div>

        <div class="cardBlock">
          <table class="tableBasic">
            <tr>
              <th>码长</th>
              <th>总键数</th>
              <th>上屏数</th>
              <th>缺字数</th>
            </tr>
            <tr>
              <td>{{.CodeLen.PerChar | printf "%.3f"}}</td>
              <td>{{.CodeLen.Total }}</td>
              <td>{{.Basic.Commits }}</td>
              <td>{{.Basic.Lacks }}</td>
            </tr>

            <tr>
              <th>打词数</th>
              <th>打词字数</th>
              <th>选重数</th>
              <th>选重字数</th>
            </tr>
            <tr>
              <td>{{.Words.Commits.Count }}</td>
              <td>{{.Words.Chars.Count }}</td>
              <td>{{.Collision.Commits.Count }}</td>
              <td>{{.Collision.Chars.Count }}</td>
            </tr>
            <tr>
              <td>{{.Words.Commits.Rate | toPer }}</td>
              <td>{{.Words.Chars.Rate | toPer }}</td>
              <td>{{.Collision.Commits.Rate | toPer }}</td>
              <td>{{.Collision.Chars.Rate | toPer }}</td>
            </tr>
          </table>
        </div>

        <div class="cardBlock">
          <table class="tableFeel">
            <tr>
              <th>左手</th>
              <th>左左</th>
              <th>左右</th>
              <th>右左</th>
              <th>右右</th>
            </tr>
            <tr>
              <td>{{.Hands.Left.Rate | toPer}}</td>
              <td>{{.Hands.LL.Rate | toPer}}</td>
              <td>{{.Hands.LR.Rate | toPer}}</td>
              <td>{{.Hands.RL.Rate | toPer}}</td>
              <td>{{.Hands.RR.Rate | toPer}}</td>
            </tr>
            <tr>
              <th>右手</th>
              <th>同指</th>
              <th>同键</th>
              <th>小跨排</th>
              <th>大跨排</th>
            </tr>
            <tr>
              <td>{{.Hands.Right.Rate | toPer}}</td>
              <td>{{.Fingers.Same.Rate | toPer}}</td>
              <td>{{.Combs.DoubleHit.Rate | toPer}}</td>
              <td>{{.Combs.SingleSpan.Rate | toPer}}</td>
              <td>{{.Combs.MultiSpan.Rate | toPer}}</td>
            </tr>
            <tr>
              <th>当量</th>
              <th>异手</th>
              <th>异指</th>
              <th>错手</th>
              <th>小指干扰</th>
            </tr>
            <tr>
              <td>{{.Combs.Equivalent | printf "%.3f"}}</td>
              <td>{{.Hands.Diff.Rate | toPer}}</td>
              <td>{{.Fingers.Diff.Rate | toPer}}</td>
              <td>{{.Combs.LongFingersDisturb.Rate | toPer}}</td>
              <td>{{.Combs.LittleFingersDisturb.Rate | toPer}}</td>
            </tr>
          </table>
        </div>

        <div class="cardBlock stat">
          <table class="statHead">
            <tr>
              <th>码长</th>
            </tr>
            <tr>
              <th>词长</th>
            </tr>
            <tr>
              <th>选重</th>
            </tr>
          </table>
          <div class="statTable">
            <table>
              <tr>
                {{range $k,$v := .CodeLen.Dist}} {{ if ne $v 0 }}
                <td>{{$k}}:{{$v}}</td>
                {{end}} {{end}}
              </tr>
              <tr>
                {{range $k,$v := .Words.Dist}}{{ if ne $v 0 }}
                <td>{{$k}}:{{$v}}</td>
                {{end}} {{end}}
              </tr>
              <tr>
                {{range $k,$v := .Collision.Dist}}{{ if ne $v 0 }}
                <td>{{$k}}:{{$v}}</td>
                {{end}} {{end}}
              </tr>
            </table>
          </div>
        </div>

        <div class="cardBlock">
          <div class="keyRateTitle">按键频率 %</div>
          <table class="heatMap">
            {{range .KeyHeatMap}}
            <tr>
              {{range .}} {{.}}{{end}}
            </tr>
            {{end}}
            <tr class="finHeatMap">
              {{range .FinHeatMap}} {{.}} {{end}}
            </tr>
          </table>
        </div>
      </div>
      {{end}}
    </div>
    <div id="footer">
      <a href="https://github.com/cxcn/gosmq" target="_blank">访问仓库</a>
    </div>
  </body>
</html>
